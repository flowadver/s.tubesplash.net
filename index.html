<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirect Page</title>
    <script>
        // Function to detect if user is in a WebView
        function isWebView() {
            var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            return (/wv|WebView|; wv/).test(userAgent) || 
                   (window.navigator.standalone === false) ||
                   (window.matchMedia('(display-mode: standalone)').matches);
        }

        // Function to get URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Redirect if not WebView, otherwise block
        if (isWebView()) {
            // Block WebView traffic
            document.write("<p>Access from WebView is not allowed.</p>");
        } else {
            // Get URL parameters
            var clickId = getUrlParameter('click_id');
            var sourceId = getUrlParameter('source_id');
            var subId = getUrlParameter('sub_id');
            var campaignId = getUrlParameter('campaign_id');

            // Redirect to target URL with parameters
            var redirectUrl = "https://a.tubesplash.net/6704b00002e701cd2d1fe937?pubid=" + sourceId + "&affsub2=" + subId + "&ref_id=" + clickId;
            window.location.href = redirectUrl;
        }
    </script>   
</head>
<body>
    <p>If it doesn't redirect automatically, click it <a id="redirectLink">here</a>.</p>

    <script>
        // Update fallback link in case redirection fails
        document.getElementById("redirectLink").href = "https://a.tubesplash.net/6704b00002e701cd2d1fe937?pubid=" + getUrlParameter('source_id') + "&affsub2=" + getUrlParameter('sub_id') + "&ref_id=" + getUrlParameter('click_id');
    </script>
</body>
</html>
